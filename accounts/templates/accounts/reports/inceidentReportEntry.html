{% extends 'accounts/index.html' %}

{% block header %}
Daily
{% endblock header %}


{% block content %}
    <div class="incedentReportEntryMain">
        <form method="POST" class="incedentReportEntryMainform">
            {% csrf_token %}
            <div>
                <p>Incident</p>
                <select name="inceident" id="">
                    {% for inceident  in inceidents  %}
                        <option value='{{inceident.inceidentName}}'>{{inceident.inceidentName}}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <p>Date</p>
                <input type="date" name="date" id="date"  required max="today">
            </div>
            <div>
                <p>ReceivedTime</p>
                <input type="text"  name="receivedTime" id="receivedTime" maxlength="5"  required >
            </div>
            <div>
                <p>EnrouteTime</p>
                <input type="text" name="enrouteTime"  id="enrouteTime" maxlength="5" required>
            </div>
            <div>
                <p>ArivedTime</p>
                <input type="text" name="arivedTime"  id="arivedTime" maxlength="5" required>
            </div>
            <div>
                <p>ClearTime</p>
                <input type="text" name="clearTime" id="clearTime" maxlength="5" required>
            </div>
            <div>
                <p>Location</p>
                <select name="location" id="">
                    {% for location  in locations  %}
                        <option value='{{location}}'>{{location}}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <p>summary</p>
                <textarea name="summary" id="" cols="30" rows="5"></textarea>
            </div>

            <button type="submit" class="muleInspectionEntrybutton">Submit</button>
        </form>
    </div>
{% endblock content %}

{% block script %}

<script nonce="{{request.csp_nonce}}" >

    document.getElementById("date").addEventListener("click", function () {
        dateMaxSet();
    });
    function dateMaxSet(){
        // get todays date
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        var yyyy = today.getFullYear();
        today = yyyy + '-' + mm + '-' + dd;
        // set todays date as the max selectable date
        document.getElementById("date").max = today;
    }

    window.addEventListener('load', (event) => {

        document.getElementById("receivedTime").addEventListener('input', function () {
            check_time(document.getElementById("receivedTime").value,"receivedTime");

        });
        document.getElementById("enrouteTime").addEventListener('input', function () {
            check_time(document.getElementById("enrouteTime").value,"enrouteTime");
        });
        document.getElementById("arivedTime").addEventListener('input', function () {
            check_time(document.getElementById("arivedTime").value,"arivedTime");
        });
        document.getElementById("clearTime").addEventListener('input', function () {
            check_time(document.getElementById("clearTime").value,"clearTime");
        });
    });






    function check_time(time,elem){
        var count =0;
        if(time[2]!=":"){
            for(i=0;i<5;i++){
            if(time[i]!=undefined){
                count = count +1;
            }
        }
        document.onkeypress = function(event){
            //alert(event.key)
            if(event.key==''){
                count=count-1;
                time = time.slice(0, -1);
            }else{
                if(count == 2){
                    time = time +":";
                    count=count+1;
                    document.getElementById(String(elem)).value = String(time);
                }
            }
        }
        }
    }
</script>
{% endblock script %}